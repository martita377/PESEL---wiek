<html>
<head>
  <meta charset="utf-8">
  <title>Mocha Tests</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mocha/4.0.1/mocha.css" rel="stylesheet">
</head>
<body>
  <div id="mocha"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/4.0.1/mocha.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sinon.js/4.0.1/sinon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/4.1.2/chai.min.js"></script>
  <script src="./vendor/sinon-chai.js"></script>

  <script>mocha.setup({ui: 'bdd'})</script>
  <script type="text/javascript" src="../js/checkAge.js"></script>
  <script type="text/javascript">
    var expect = chai.expect;

    describe('#check pesel', function() {

      beforeEach(function() {
        sinon.stub(window, "alert");
        sinon.stub(console, "log");
      })

      afterEach(function() {
        window.alert.restore();
        console.log.restore();
      })

      describe('Invalid PESEL', function() {
        it('PESEL 0113101k457 - couse alert "Błędny numer"', function() {
          checkAge('0113101k457');

          expect(window.alert).to.have.been.calledWith("PESEL nieprawidłowy - sprawdź cyfry");
        });
      });

      describe('Valid PESEL', function() {
        it('PESEL 83031813892 - returns object"', function() {
          var ret = checkAge('83031813892');

          expect(ret).to.have.keys('yearPesel', 'monthPesel', 'dayPesel');
        });
      });
    })
  </script>
  <script>
    mocha.checkLeaks();
    mocha.run();
  </script>
</body>
</html>